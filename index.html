<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Socket.IO Multiplayer</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; background: #f0f0f0; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="600" height="600"></canvas>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const socket = io("maysy-production.up.railway.app");
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let player = {
      id: null,
      x: Math.floor(Math.random() * 20),
      y: Math.floor(Math.random() * 20),
      color: "#" + Math.floor(Math.random() * 16777215).toString(16)
    };

    let players = {};

    socket.on("connect", () => {
      player.id = socket.id;
      socket.emit("new-player", player);
    });

    socket.on("update-players", (data) => {
      players = data;
      draw();
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowUp") player.y--;
      if (e.key === "ArrowDown") player.y++;
      if (e.key === "ArrowLeft") player.x--;
      if (e.key === "ArrowRight") player.x++;
      socket.emit("move-player", player);
    });

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let id in players) {
        const p = players[id];
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x * 30 + 15, p.y * 30 + 15, 12, 0, Math.PI * 2);
        ctx.fill();
      }
    }
  </script>
</body>
</html>
